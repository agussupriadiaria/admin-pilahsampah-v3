USE u682594628_BxZ8n;
INSERT INTO savedatabaru (date, jumlahbottle, saldo, transactioncode)
SELECT sd.date, sd.jumlahbottle, sd.saldo, sd.transactioncode
FROM savedata AS sd
WHERE (sd.transactioncode, sd.saldo) IN (
	SELECT transactioncode, MAX(saldo)
	FROM savedata
	GROUP BY transactioncode
)
AND sd.transactioncode NOT IN (
	SELECT transactioncode
	FROM savedatabaru
);

TRUNCATE savedata;