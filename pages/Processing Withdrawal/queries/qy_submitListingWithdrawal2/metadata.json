{
  "gitSyncId": "689d5bb735154e6d78240bfd_35b833a5-d7c6-40da-a6c7-396f85bec02a",
  "id": "Processing Withdrawal_qy_submitListingWithdrawal2",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "START TRANSACTION;\n\n-- Buat temporary table untuk simpan hasil grouping\nCREATE TEMPORARY TABLE tmp_grouped AS\nSELECT \n    entry_id,\n    MAX(CASE WHEN meta_key = 'number-1' THEN meta_value END) AS number1,\n    MAX(CASE WHEN meta_key = 'hidden-1' THEN meta_value END) AS user_id,\n    MAX(CASE WHEN meta_key = 'hidden-2' THEN meta_value END) AS user_name,\n    MAX(CASE WHEN meta_key = 'hidden-3' THEN meta_value END) AS transaction_type,\n    MIN(date_created) AS inputdate\nFROM wp_frmt_form_entry_meta\nGROUP BY entry_id;\n\n-- Insert ke transactions_wd\nINSERT INTO transactions_wd (user_id, user_name, amount, inputdate)\nSELECT \n    user_id,\n    user_name,\n    number1,\n    inputdate\nFROM tmp_grouped\nWHERE transaction_type = 'Withdrawal';\n\n-- Hapus data yang sudah dipindahkan (hanya yang Transactions)\nDELETE FROM wp_frmt_form_entry_meta\nWHERE entry_id IN (\n\tSELECT entry_id \n\tFROM tmp_grouped \n\tWHERE transaction_type = 'Withdrawal'\n);\n\nCOMMIT;",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "u682594628_BxZ8n",
      "isAutoGenerated": false,
      "name": "u682594628_BxZ8n",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [],
    "name": "qy_submitListingWithdrawal2",
    "pageId": "Processing Withdrawal",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}