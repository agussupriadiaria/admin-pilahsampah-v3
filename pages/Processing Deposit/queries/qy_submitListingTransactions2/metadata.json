{
  "gitSyncId": "689d5bb735154e6d78240bfd_fb9e17b1-e38f-44ac-aeed-10adb568adb3",
  "id": "Processing Deposit_qy_submitListingTransactions2",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "START TRANSACTION;\n\n-- Buat temporary table untuk simpan hasil grouping\nCREATE TEMPORARY TABLE tmp_grouped AS\nSELECT \n    entry_id,\n    MAX(CASE WHEN meta_key = 'number-1' THEN meta_value END) AS number1,\n    STR_TO_DATE(\n\t\t\tMAX(CASE WHEN meta_key = 'date-1' THEN meta_value END),\n\t\t\t'%d/%m/%Y'\n\t\t) AS transaction_date,\n    MAX(CASE WHEN meta_key = 'hidden-1' THEN meta_value END) AS user_id,\n    MAX(CASE WHEN meta_key = 'hidden-2' THEN meta_value END) AS user_name,\n    MAX(CASE WHEN meta_key = 'hidden-3' THEN meta_value END) AS transaction_type,\n    MIN(date_created) AS inputdate\nFROM wp_frmt_form_entry_meta\nGROUP BY entry_id;\n\n-- Insert ke transactions\nINSERT INTO transactions (transactioncode, transactiondate, user_id, user_name, inputdate)\nSELECT \n    number1,\n    transaction_date,\n    user_id,\n    user_name,\n    inputdate\nFROM tmp_grouped\nWHERE transaction_type = 'Transactions';\n\n-- Hapus data yang sudah dipindahkan (hanya yang Transactions)\nDELETE FROM wp_frmt_form_entry_meta\nWHERE entry_id IN (\n\tSELECT entry_id \n\tFROM tmp_grouped \n\tWHERE transaction_type = 'Transactions'\n);\n\nCOMMIT;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "u682594628_BxZ8n",
      "isAutoGenerated": false,
      "name": "u682594628_BxZ8n",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [],
    "name": "qy_submitListingTransactions2",
    "pageId": "Processing Deposit",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}